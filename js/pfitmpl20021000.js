var moods = {
    title: "Moods",
    url: "/look.html?t=m",
    sub: [
        {
            title: "Summer Dreams",
            url: "/summerdreams.html",
            lede: "<strong>Summer Dreams</strong> - A line in Black, Ivory and Silver, in P.F.I. Tangail using the finest Bengal cotton, lustrous Madka and Mysore silks.",
            imageURL: "/products/summerdreams/Line.jpg"
        },
        {
            title: "Vagabond",
            url: "/vagabond.html",
            lede: "The <strong>Vagabond</strong>: A capsule in a bio-washed, hand-spun, hand-loomed khadi and P.F.I. tangail - inspired by the travelers and mavericks of the world.....",
            imageURL: "/products/vagabond/KohBoy.jpg"
        },
        {
            title: "Holy Days",
            url: "/holydaysreboot.html",
            lede: "A multi-layered boho re-imagining of our classic one-of-a-kind line of sari-based <strong>Art Wear</strong>.",
            imageURL: "/products/holydaysreboot/KaftanS.jpg"
        },
        {
            title: "It's Magic!",
            url: "/itsmagic.html",
            lede: "The <strong>It's Magic</strong> capsule of colourful, <strong>reversible</strong> children's garments in 100% Voile de Cotton",
            imageURL: "/products/itsmagic/Balloon.jpg"
        }
    ]
};

var ramp = {
    title: "Ramp",
    url: "/look.html?t=r",
    sub: [
        {
            title: 'Va-Va Voom',
            url: '/look/vvv.html',
            lede: 'Distinctive Designs in Treasured Textiles',
            imageURL: "/look/ramp/em.jpg"
        },
        {
            title: 'Move~in',
            url: '/look/wc.html',
            lede: 'Casual Looks featuring my Woven Canvas Ts',
            imageURL: "/look/ramp/wcw2.jpg"
        }
    ]
};

var lotm = {
    title: "Look!",
    url: "/look.html?t=p",
    sub: [
        {
            lede: 'Off-shoulder knit top with one of my signature Art Wear skirts - The Naksha.',
            imageURL: "/g/look/nkshofstp.jpg"
        },
        {
            lede: 'New! Black &amp; Silver spandex creation with deep handwoven neckline.',
            imageURL: "/g/look/bwspndnew.jpg"
        },
        {
            lede: 'All set to trick-or-treat in Kitty Mask with hand-embroidered sequins, Peekaboo Top and Jeggings.',
            imageURL: "/g/look/Halloween.jpg"
        },
        {
            title: 'Look-of-the-Month',
            url: '/look/lotm.html',
            lede: 'How we started our impromptu Look-of-the-Moment series of images',
            imageURL: "/g/look/look01.jpg"
        }
    ]
};

var archives = {
    title: "Look Back",
    url: "/blog.html?t=l",
    sub: [
        {
            title: "Happy Everyday",
            url: "/blog/lb/hed.html",
            lede: 'Some interesting designs from early work on my Happy Everyday line.',
            imageURL: "/blog/lb/hed2.jpg"
        },
        {
            title: "Delta &amp; Naksha",
            url: "/blog/lb/dnn.html",
            lede: 'Older images of the Delta Dress and Naksha Scarf',
            imageURL: "/blog/lb/lb3.jpg"
        }
    ]
};

var origin = {
        title: "My Journey",
        url: "/blog.html?t=o",
        sub: [
            {
                title: "Prema's Story",
                url: "/journey/myjourney.html",
                lede: 'Over the years, I have told this story in bits and pieces to clients and friends, who kept asking why it was not on the website.....',
                imageURL: "/journey/PremaStory.jpg"
            },
            {
                title: "Auroville",
                url: "/journey/auroville.html",
                lede: 'Auroville is the center of my journey',
                imageURL: "/journey/GrowingUp.jpg"
            },
            {
                title: "Odissi 2 Salsa!",
                url: "/journey/salsa.html",
                lede: 'How my changing dance passions led me to fashion design',
                imageURL: "/journey/NakshaEvolution.jpg"
            },
            {
                title: "The Atelier",
                url: "/journey/atelier.html",
                lede: 'The history of my Rangoli Atelier',
                imageURL: "/journey/TeamYears.jpg"
            },
            {
                title: "Rang = Colour",
                url: "/journey/colour.html",
                lede: 'Rangoli is the expression of artistic vision through the joyful use of colour',
                imageURL: "/journey/LogoRangoli.jpg"
            },
            {
                title: "Tangail Traditions",
                url: "/journey/tangail.html",
                lede: 'My inspiration and signature fabric, originally created for the Moghul Emperors',
                imageURL: "/journey/Saris.jpg"
            },
            {
                title: "Treasure Trove",
                url: "/journey/treasuretrove.html",
                lede: 'How I wound up creating a treasure trove of vintage tangail borders',
                imageHTML: "<script>document.write(createPanelCarousel())</scr" + "ipt>"
            },
            {
                title: "Art Wear",
                url: "/journey/artwear.html",
                lede: 'The origin story of my one-of-a-kind Art Wear line',
                imageURL: "/g/aw/HDRKaftan1AW.jpg"
            },
            {
                title: "P.F.I. Tangail",
                url: "/journey/pfifabrics.html",
                lede: '<strong>A Bouquet of Borders!</strong> How and Why I created my own line of fabrics: <strong>P.F.I. Tangail</strong>',
                imageURL: "/journey/PreciousI.jpg"
            },
            {
                title: "Evolution",
                url: "/journey/evolution.html",
                lede: 'Influences on my evolution as an artist',
                imageURL: "/journey/EdExp.jpg"
            }
        ]
    };

var atelier = {
    title: "Atelier Tales",
    url: "/blog.html?t=a",
    sub: [
        {
            title: "Florence in Florence",
            url: "/blog/finf.html",
            lede: 'Notes from a short holiday in Florence.',
            imageURL: "/blog/FlorDuomo.jpg"
        },
        {
            title: "Vilnius Artists",
            url: "/blog/vilartists.html",
            lede: 'Visiting Vilnius  - Meeting some inspirational artists.',
            imageURL: "/blog/unda.jpg"
        },
        {
            title: "UNESCO Talk",
            url: "/blog/unesco.html",
            lede: 'Visiting Vilnius - My talk at the UNESCO hall.',
            imageURL: "/blog/utalk1.jpg"
        },
        {
            title: "The G-Spot!",
            url: "/blog/gspot.html",
            lede: 'Visiting Vilnius - The G-Spot of Europe.',
            imageURL: "/blog/oldtown.jpg"
        },
        {
            title: "Vignettes",
            url: "/atelier/vignettes.html",
            lede: 'Vignettes from in and around the Atelier',
            imageURL: "/atelier/sott.jpg"
        },
        {
            title: "Fashion Week",
            url: "/fw/fashionweek.html",
            lede: 'In September, I put together my first ever fashion show at <strong>Fashion Week Pondicherry!</strong>',
            imageURL: "/fw/finale.jpg"
        },
        {
            title: "Dream Team",
            url: "/atelier/dreamteam.html",
            lede: 'My work family - they are a big part of what makes my Rangoli Atelier tick!',
            imageURL: "/atelier/PFW.jpg"
        },
        {
            title: "Tapestries!",
            url: "/tapestries/tapestries.html",
            lede: 'An artistic collaboration with Montreal photographer <strong>Jérémi Poulin</strong>',
            imageURL: "/tapestries/JP-7374.jpg"
        },
        {
            title: "Tangail Art",
            url: "/tangailcollage.html",
            lede: 'Some time ago, I started creating <strong>one-of-a-kind, numbered Woven Canvases</strong> using borders from my <strong>Treasure Trove</strong>...',
            imageURL: "/g/blog/CllgPrcSq.jpg"
        },
        {
            title: "Pranayama",
            url: "/atelier/pranayama.html",
            lede: 'We are sharing some pictures we recently received of the morning Pranayama sessions at the atelier.',
            imageURL: "/atelier/PranSq.jpg"
        },
        {
            title: "KidinMi Launch",
            url: "/kidinmi.html",
            lede: 'After 10 years on the drawing boards, I am finally ready to launch my new kids label!! - <strong>KidinMi</strong>',
            imageURL: "/g/kimgphsimp.svg"
        }
    ]
};

var clients = {
    title: "Real People",
    url: "/about.html?a=c&#about-tabs",
    sub: [
        {
            title: "Curators",
            url: "/people/curators.html",
            lede: "A trio of curators that like my designs",
            imageURL: "/people/mmib.jpg"
        },
        {
            title: "Ibiza Living!",
            url: "/people/resortwear.html",
            lede: "At a beach resort on Ibiza",
            imageURL: "/people/ibgirl.jpg"
        },
        {
            title: "Birthday Boy",
            url: "/blog/bdayboy.html",
            lede: "The story of my meeting with a group of Israeli artists.",
            imageURL: "/blog/nir03.jpg"
        }
    ]
};

var about = {
    title: "About",
    url: "/about.html",
    sub: [
        {
            title: "Essence",
            url: '/essence.html',
            lede: 'The Essence of my Way',
            imageURL: '/g/premabydinh.jpg'
        },
        {
            title: "Inspiration",
            url: '/beauty.html',
            lede: 'The Beauty of the Tangail Handloom Tradition',
            imageURL: '/g/w/IMG_0093.jpg'
        },
        {
            title: "Visit",
            url: '/visitus.html',
            lede: 'How to visit our locations',
            imageURL: '/atelier/mib.jpg'
        }
    ]
};

var buzzTL = {
    title: "Buzzing...",
    url: "/about.html?a=b&#about-tabs",
    sub: []
};

var buzz = {
    title: "Buzzing...",
    url: "/about.html?a=b&#about-tabs",
    lede: 'Media coverage, both traditional and new.',
    sub: [
        {
            title: "Voice of Fashion",
            url: "https://thevoiceoffashion.com/fabric-of-india/the-south-india-edit/tangail-territory-in-auroville-2849",
            lede: 'A really well-written article and accompanying video by The Voice of Fashion',
            imageHTML: '<iframe class="embed-responsive-item" title="vimeo-player"  src="https://player.vimeo.com/video/349628022" frameborder="0" allowfullscreen></iframe>'
        },
        {
            title: "Yves Richez",
            url: "https://www.talentreveal.com/blog/rencontre-avec-prema-florence-isaac-creatrice-et-entrepreneuse-solidaire-en-inde",
            lede: 'Presenting a short documentary (in French) created by the delightful <a href="https://www.facebook.com/richez.yves">Yves Richez</a>, who visited the atelier a while ago. Scholar, writer and teacher par-excellence, Yves is committed to finding and developing human potential all around him. During his short visit, he taught me how to start creating my own videos. His presence is inspirational!</p><p>We are still trying to decide if he looks more like Richard Gere or Aidan Gillen :-)',
            imageHTML: '<iframe class="embed-responsive-item" src="https://www.youtube.com/embed/UD5KhbKHvCI?start=5" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>'
        },
        {
            title: "Yves Story",
            url: "https://www.linkedin.com/pulse/prema-florence-isaac-yves-richez-ph-d-/",
            lede: 'Yves also wrote a short piece about our meeting on LinkedIn - Meeting with Prema Florence Isaac, creative and entrepreneur in India.',
            imageURL: "https://www.talentreveal.com/uploads/3/1/2/1/31219479/talentreveallogo2018.png"
        },
        {
            title: "Alia ૐ",
            url: "https://aliaom.com/alia-yoga-prema-design-auroville/",
            lede: "Check out the blog article of Alia M'Hamdi, women's yoga teacher, about our meeting and her visit to the atelier.",
            imageURL: "https://aliaom.com/wp-content/uploads/2017/03/Alia-@-The-Pink-Temple-Auroville-India.jpg"
        },
        {
            title: "Lila",
            url: "https://lila.lt/en/2018/12/prema-florence-isaac-at-first-i-look-within/",
            lede: 'Here is the first part of a story in Lila Magazine. I was interviewed by the wonderful journalist Ginta Gaivenyte.',
            imageURL: "https://lila.lt/wp-content/uploads/sites/10/2018/07/lila_logo_sviesa.png"
        },
        {
            title: "Auroville.com",
            url: "https://www.auroville.com/blog/post/meet-auroville:-prema-from-rangoli",
            lede: 'I was interviewed by Taranti for this nice article on the blog of the  Auroville Online Store.',
            imageHTML: '<figure><img src="/g/premabydinh.jpg" class="img-fluid center-block"><figcaption><small>Image: Dinh Thi Thien</small></figcaption></figure>'
        },
        {
            title: "Erika Lernot",
            url: "http://www.lesvoyagesderika.fr/mon-look-reves-de-cuba-by-rangoli/",
            lede: '<strong>Mon look - Reves de Cuba</strong> - a blog by Erika Lernot, singer and traveler, who modeled our <a href="summerdreams.html">A Midsummer Nights Dream</a> Mood.',
            imageURL: "https://i1.wp.com/www.lesvoyagesderika.fr/wp-content/uploads/2015/11/Erika-tet-mare-.jpg?zoom=2&resize=666%2C352"
        },
        {
            title: "The Hindu",
            url: "https://www.thehindu.com/features/metroplus/fashion/Ethically-swish/article16881597.ece",
            lede: '<strong>Ethically Swish</strong> - a story about Prema in The Hindu',
            imageURL: "https://www.thehindu.com/migration_catalog/article16861703.ece/ALTERNATES/FREE_660/MP16_RANGOLI.JPG"
        }
    ]
};

var shop = {
        title: "Shop",
        url: "/shop.html",
        sub: [
        {
            title: "Woven Canvas",
            url: "/fabricartT.html"
        },
        {
            title: "Dip-Dye Scarf",
            url: "/products/scarves/dipdye.html"
        },
        {
            title: "Kagera Tie",
            url: "/products/ties/kagera.html"
        },
        {
            title: "Champagne Bottle Bag",
            url: "/products/home/champagnebag.html"
        }
    ]
};

var faqs = {
        title: "Shop FAQ",
        url: "/shopfaq.html",
        sub: [
    ]
};


var siteMap = [
    {
        sub: [
            {
                title: "Blog",
                url: "/blog.html"
            },
            {
                title: "About Us",
                url: "/about.html"
            },
            {
                title: "Look",
                url: "/look.html"
            }
        ]
    },
    origin,
    atelier,
    clients,
    about,
    buzz,
    moods,
    ramp,
    archives,
    lotm,
    shop
];

function getHostName(url) {
    var match = url.match(/:\/\/(www[0-9]?\.)?(.[^/:]+)/i);
    if (match != null && match.length > 2 && typeof match[2] === 'string' && match[2].length > 0) {
    return match[2];
    }
    else {
        return null;
    }
}

function getUrlVars() {
    var vars = {};
    var parts = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m,key,value) {
        vars[key] = value;
    });
    return vars;
}

function createSqPanelImageList(panelNumArr) {
    var res = [];
    for (var i = 0; i < panelNumArr.length; i++) {
        res.push({imageURL: "/tbc/sqIC/IC" + panelNumArr[i] + ".jpg"});
    }
    return res;
}


function createPanelCarousel() {
    var panelNums = [545,548,549,552,565,571];
    var panelImgs  =  createSqPanelImageList(panelNums);
    return createCarousel("car-panels", panelImgs);
}

function selectFeature(section) {
    var len = section.sub.length;
    var rndI = Math.floor(Math.random() * len);
    return section.sub[ rndI ];
}

function selectFeatures(sections) {
    var items = [];
    var pars = [];
    for (var i = 0; i < sections.length; i++ ) {
        var sec = sections[ i ];
        var sel = selectFeature(sec);
        items.push(sel);
        pars.push(sec);
    }
    return [items, pars];
}

function createBreadCrumb(location) {
    var path = location;
    for (var i = 0; i < siteMap.length; i++) {
        var level1 = siteMap[ i ];
        for (var j = 0; j < level1.sub.length; j++) {
            var level2 = level1.sub[ j ];
            if ( level2.url == path ) {
                return createBreadCrumbLevels(level1, level2);
            }
        }
    }
    return "";
}            

function createBreadCrumbLevels(level1, level2) {
    var res = '<nav class="py-2"><div class="container"><div class="row"><div class="col-12"><ol class="breadcrumb mb-0 font-size-xs text-gray-400">';
    res +='<li class="breadcrumb-item"><a class="text-gray-400" href="/index.html">Home</a></li>';
    if ( level1.title !== undefined ) {
        res +='<li class="breadcrumb-item"><a class="text-gray-400" href="' + level1.url + '">' + level1.title + '</a></li>';
    }
    res +='<li class="breadcrumb-item active">' + level2.title + '</a></li>';
    res += '</ol></div></div></div></nav>';
    return res;
}

function createStyledList(jsonArray) {
var res = '<ul class="list-styled mb-6 font-size-sm">';
    for (var i = 0; i < jsonArray.length; i++ ) {
        var item = jsonArray[ i ];
        if  (item.title === undefined) {
            continue;
        }
        res += '<li class="list-styled-item"><a class="list-styled-link" href="' + item.url + '"' +  (getHostName(item.url) === null ? "" : ' target="_blank"') + '>' + item.title + (getHostName(item.url) === null ? "" :  ' <i class="fa fa-external-link"></i>') + '</a></li>';
    }
    res +=  '</ul>';
    return res; 
}
    
function createDropdownColumn(itemLists, colCls){
    var res = '<div class="' + colCls + '">';
    for( var i = 0; i < itemLists.length; i++ ) {
        var item = itemLists[ i ];
        if (item.title === undefined) {
            continue;
        }
        res += '<div class="' + (i === 0 ? "mb-5" : "my-5") + ' font-weight-bold">';
        if  ( item.url !== undefined ) {
            if  (getHostName(item.url) === null) {
                res += '<a href="' + item.url + '">';
            } else {
                res += '<a href="' + item.url + '" target="_blank">';
            }
        }
        res += item.title;
        if  ( item.url !== undefined ) {
            if  (getHostName(item.url) === null) {
                res += '</a>';
            } else {
                res += '<i class="fa fa-external-link-alt"></i></a>';
            }
        }
        res += '</div>';
        res += createStyledList(item.sub);
    }
    res += '</div>';
    return  res;
}

function createDropdownCard(cols) {
    var  res  = '<div class="card"><div class="card-body"><div class="row">';
    for (var i = 0; i < cols.length; i++) {
        res += cols[ i ];
    }
    res += '</div></div></div>';
    return res;
}

function createMinWidthDDCard(cols, width, alignRight) {
    var  res  = '<div class="dropdown-menu' + (alignRight ? " dropdown-menu-right" : "") + '" style="min-width: ' + width +';">';
    res += createDropdownCard(cols);
    res += '</div>';
    return res;
}

function createFullWidthDDCard(cols)  {
    var  res  = '<div class="dropdown-menu w-100"><div class="container">';
    res += createDropdownCard(cols);
    res += '</div></div>';
    return res;    
}

function createMegaMenuSection(item) {
    return '<div class="col-6 col-md">\
    <div class="mb-5 font-weight-bold">' + item.title + '</div>'
    + createStyledList(item.sub) + '</div>';
}

function createMegaMenuImage(item) {
    return '<div class="col-4 d-none d-lg-block">\
    <div class="card">\
        <img class="card-img" src="' + item.imageURL + '" alt="...">\
        <div class="card-img-overlay bg-dark-0 bg-hover align-items-center">\
            <div class="text-center">\
            <a class="btn btn-white stretched-link" href="' + item.url + '">'
                + item.title  + '<i class="fa fa-arrow-right ml-2"></i></a>\
            </div>\
        </div>\
    </div>\
    </div>';
}

function createShopMM() {
    var col1 = createDropdownColumn([shop, faqs], "col-12");
    return createMinWidthDDCard([col1], "190px", false);
}

function createLookMM() {
    var col1 = createDropdownColumn([lotm, ramp], "col-6");
    var col2 = createDropdownColumn([moods], "col-6");
    return createMinWidthDDCard([col1, col2], "305px", true);
}

function createBlogDD () {
    var col1 = createDropdownColumn([atelier], "col-6");
    var col2 = createDropdownColumn([origin, archives], "col-6");
    return createMinWidthDDCard([col1, col2], "345px", true);
}

function createAboutDD () {
    var col1 = createDropdownColumn([about, buzzTL, clients], "col-12");
    return createMinWidthDDCard([col1], "145px", true);
}

function createTopNav() {
    var res = '<ul class="nav nav-justified py-0">';
    
    res += '<li class="nav-item dropdown"><a class="nav-link" data-toggle="dropdown" href="#">Shop</a>';
    res += createShopMM();
    res += '</li>';

    res += '<li class="nav-item dropdown"><a class="nav-link" data-toggle="dropdown" href="#">Look</a>'
    res += createLookMM();
    res += '</li>';

    res += '<li class="nav-item dropdown"><a class="nav-link" data-toggle="dropdown" href="#">Blog</a>';
    res += createBlogDD();
    res += '</li>';

    res += '<li class="nav-item dropdown"><a class="nav-link" data-toggle="dropdown" href="#">About</a>';
    res += createAboutDD();
    res += '</li>';

    res += '</ul>';
    return res;
}


function pfisig() {
    return '<strong>Prema Florence Isaac</strong>';
}

function getTabItem(title, id, isActive) {
    return '<li class="nav-item"><a class="nav-link' +
        (isActive ? ' active' : '') + '"  data-toggle="tab" href="#' + id + '" role="tab">' + title + '</a></li>';
}

function getTabContent(content, id, isActive) {
    return '<div class="tab-pane fade' + (isActive ? " show active" : "") 
        + '" id="' + id + '" role="tabpanel">'
        + content
        + '</div>';
}

function createFeatureItemCard(item, section) {
    var res = '<div class="card mb-2">';
    if ( item.imageURL !== undefined) {
        res += '<div class="embed-responsive embed-responsive-1by1">';
        res += '<img src="' + item.imageURL + '" alt="' + item.title  + '" class="embed-responsive-item" style="object-fit: cover">';
        res += '</div>';
    } else if (item.imageHTML !== undefined ) {
        res += item.imageHTML;
    }
    res += '<div class="card-body px-0 pt-6 pb-4">';
    res += '<div class="card-subtitle mb-1"><a class="text-muted" href="'  + section.url + '">' + section.title +'</a></div>';
    if  ( item.url !== undefined ) {
        res += '<h6 class="card-title mb-2">' + item.title + '<a  href="' + item.url + '"' +(getHostName(item.url) === null ? '' : ' target="_blank"') +  '><i class="fa ' + (getHostName(item.url) === null ? 'fa-arrow-right' : 'fa-external-link') + ' ml-2"></i></a></h6>';
    }
    res += '<p class="mb-1">' + item.lede + '</p>';
    res += '</div></div>';
    return res;
}

function createItemCard(item) {
    var res = '<div class="card mb-2">';
    if ( item.badge !== undefined ) {
        res += '<div class="badge badge-white card-badge card-badge-left text-uppercase">' + item.badge + '</div>';
    }
    if ( item.imageURL !== undefined) {
        res += '<div class="embed-responsive embed-responsive-1by1">';
        res += '<img src="' + item.imageURL + '" alt="' + item.title  + '" class="embed-responsive-item" style="object-fit: cover">';
        res += '</div>';
    } else if (item.imageHTML !== undefined ) {
        res += item.imageHTML;
    }
    res += '<div class="card-body px-0 pt-6 pb-4">';
    if  (item.url !== undefined) {
        res += '<h6 class="card-title mb-2">' + item.title + '<a  href="' + item.url + '"' +(getHostName(item.url) === null ? '' : ' target="_blank"') +  '><i class="fa ' + (getHostName(item.url) === null ? 'fa-arrow-right' : 'fa-external-link') + ' ml-2"></i></a></h6>';
    }
    res += '<p class="mb-1">' + item.lede + '</p>';
    res += '</div></div>';
    return res;
}

function createSection(pages) {
    var brkColCls = "col-md-4";
    var res = '<section class="pt-5 pb-3"><div class="container"><div class="row">';
    for (var i = 0; i < pages.sub.length; i++) {
        res += '<div class="col-12 ' + brkColCls + '">';
        res += createItemCard(pages.sub[ i ]);
        res += '</div>';
    }
    res += '</div></div></section>';
    return res;
}

function createRelated(header, items, sections) {
    var brkColCls = "col-sm-6 col-md-3";
    var res = '<div class="container mb-5"><h5>' + header + '</h5><section class="pt-4"><div class="container"><div class="row">';
    for (var i = 0; i < items.length; i++) {
        res += '<div class="col-6 ' + brkColCls + '">' +  createFeatureItemCard(items[ i ], sections[ i ]) + '</div>';
    }
    res += '</div></div></section></div>';
    return res;
}

function pickSection(section) {
    var len = section.length;
    var rndI = Math.floor(Math.random() * len);
    return section[ rndI ];
}

function selectSections() {
    return [atelier, pickSection([about, buzz, archives, lotm]), pickSection([moods, ramp, clients]), origin];
}

function createFeatures(header) {
    var res = selectFeatures(selectSections());
    return createRelated(header, res[0], res[1]);
}

function createCarousel(carId, carItems) {
    var id = "carousel-" + carId;
    var res = '<div id="' + id + '" class="carousel slide" data-ride="carousel" data-interval="2500"><ol class="carousel-indicators">';
    for (var i = 0; i < carItems.length; i++) {
        res += '<li data-target="#' + id + '" data-slide-to="' + i + '"' + (i == 0 ? '" class="active"' : '') + '></li>';
    }
    res += '</ol><div class="carousel-inner">';
    for (i = 0; i < carItems.length; i++) {
        res += '<div class="carousel-item' + (i == 0 ? ' active' : '') + '">'
                + '<img class="d-block w-100" src="' + carItems[i].imageURL + '">'
                + '</div>';
    }
    res += '</div>\
    <a class="carousel-control-prev" href="#' + id + '" role="button" data-slide="prev">\
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>\
        <span class="sr-only">Previous</span>\
    </a>\
    <a class="carousel-control-next" href="#' + id + '" role="button" data-slide="next">\
        <span class="carousel-control-next-icon" aria-hidden="true"></span>\
        <span class="sr-only">Next</span>\
    </a>\
</div>';
    return res;
}

function gaFunnel(funnel) {
    if ( funnel === "Lead") {
        return "generate_lead";
    } else if ( funnel === "ViewContent") {
        return "view_item";
    } else {
        return "page_view";
    }
}

function fbFunnel(funnel) {
    if ( funnel === "Lead" || funnel === "ViewContent") {
        return funnel;
    } else {
        return "PageView";
    }
}

function gaInit(gaCode, eventType) {
    var ret = '<scr' + 'ipt>\
  window.dataLayer = window.dataLayer || [];\
  function gtag(){dataLayer.push(arguments);}\
  gtag("js", new Date());\
  gtag("config", "' + gaCode + '");\
  gtag("config", "AW-861963921");';
    if ( eventType != "page_view" ) {
        ret += 'gtag("event", "' + eventType + '");';
    }
    ret += '</scr' + 'ipt>';
    return ret;
}

function fbInit(fbpCode, eventType) {
    var ret = '<sc' + 'ript>\
!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?\
n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;\
n.push=n;n.loaded=!0;n.version="2.0";n.queue=[];t=b.createElement(e);t.async=!0;\
t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,\
document,"script","//connect.facebook.net/en_US/fbevents.js");\
fbq("init","' + fbpCode + '");fbq("track","PageView");';
    if ( eventType != "PageView" ) {
        ret += 'fbq("track", "' + eventType + '");';
    }
    ret += '</scr' + 'ipt>';
    return ret;
}

function shareInit() {
    return fbShareInit() + twitterShareInit();
}

function fbShareInit() {
    return '<div id="fb-root"></div>\
<sc' + 'ript>(function(d, s, id) {\
  var js, fjs = d.getElementsByTagName(s)[0];\
  if (d.getElementById(id)) return;\
  js = d.createElement(s); js.id = id;\
  js.src = "https://connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v2.12";\
  fjs.parentNode.insertBefore(js, fjs);\
}(document, "sc' + 'ript", "facebook-jssdk"));</sc' + 'ript>';   
}

function twitterShareInit() {
    return '<sc' + 'ript>window.twttr = (function(d, s, id) {\
  var js, fjs = d.getElementsByTagName(s)[0],\
    t = window.twttr || {};\
  if (d.getElementById(id)) return t;\
  js = d.createElement(s);\
  js.id = id;\
  js.src = "https://platform.twitter.com/widgets.js";\
  fjs.parentNode.insertBefore(js, fjs);\
  t._e = [];\
  t.ready = function(f) {\
    t._e.push(f);\
  };\
  return t;\
}(document, "sc' + 'ript", "twitter-wjs"));</sc' + 'ript>'
    ;
}

function pfiTopMenu (location) {
    return shareInit() +
        '<div class="rwell text-center">\
            <small><strong>Distinctive Designs . Fusion Flair . Textile Treasures</strong></small>\
    </div>'+ '<div class="container p-0">' + '<div class="text-center px-3 pt-3 pb-2"><a href="/index.html"><img src="/g/pfilogo2002.svg" alt="Prema Florence Isaac" class="img-fluid" width="1000px"></a></div>'
        + createTopNav() + '</div>' + createBreadCrumb(location);
}

function kimTopMenu (location) {
    return shareInit() +
        '<div class="rwell text-center">\
            <small><strong>Distinctive Designs . Fusion Flair . Textile Treasures</strong></small></div>'  + '<div class="container p-0">'
    + '<div class="item text-center px-3 pt-3 pb-2"><a href="/kidinmi.html"><img src="/g/kimlogo.svg" alt="KidInMi" class="img-fluid" width="300px"></a></div>'
        + createTopNav() + '</div>'  + createBreadCrumb(location);
}

function creatFBShareBtn(location) {
    var fullPath = location;
    return '<div class="fb-share-button" data-href="' 
        + fullPath +
        '" data-layout="button" data-size="large" data-mobile-iframe="true"><a target="_blank" href="https://www.facebook.com/sharer/sharer.php?u='
        + encodeURI(fullPath) +
        '&amp;src=sdkpreparse" class="fb-xfbml-parse-ignore">Share</a></div>';
}

function creatTweetBtn(location) {
    var fullPath = location;
    return '<a class="twitter-share-button" href="https://twitter.com/intent/tweet?url=' + encodeURI(fullPath) + '" data-size="large">Tweet</a>';
}

function createINBtn(location) {
    return '<script src="https://platform.linkedin.com/in.js" type="text/javascript">lang: en_US</script><script type="IN/Share" data-url="' + location + '"></script>';
}

function createMCSignup() {
    return '<center><div class="form-group">\
<form action="https://premaflorenceisaac.us12.list-manage.com/subscribe/post?u=66ac2e4e6cda6ea157ef47afd&amp;id=0c8cc89a5b" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" target="_blank" novalidate>\
	<input type="email" value="Your EMail Address" name="EMAIL" class="required email">\
<input type="submit" value="Sign Up" name="subscribe" class="button">\
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_66ac2e4e6cda6ea157ef47afd_0c8cc89a5b" tabindex="-1" value=""></div>\
</form></div></center>';
}

function createShareBar(location) {
    return '<div class="container mb-5"><div style="display: flex; justify-content: space-between;">'
        + '<span>'  
        + creatFBShareBtn(location)
        + '</span>'
        + '<span>'  
        + '<a data-pin-do="buttonBookmark" data-pin-tall="true" data-pin-round="true" href="https://www.pinterest.com/pin/create/button/"><img src="//assets.pinterest.com/images/pidgets/pinit_fg_en_round_red_32.png"/>Save</a>'
        + '</span>'
        + '<span>'  
           + creatTweetBtn(location)
        + '</span>'
        + '<span>'  
           + createINBtn(location) 
        + '</span>'
        + '</div></div>';
}

function botNav(botImgTag, location) {
    return createFeatures("Featured Stories") +  createShareBar(location) +
    '<div class="rwell">\
            <p class="text-center"><strong>Light . Beauty . Freedom</strong></p>\
    </div>\
    <div class="container">\
        <div class="pb-2"><center><div class="row">\
            <div class="col-sm-6">\
        Instagram <i class="fa fa-instagram"></i>: <a href="https://www.instagram.com/_prema.florence.isaac_/">@_prema.florence.isaac_</a><br>\
        Facebook <i class="fa fa-facebook-square"></i>: <a href="https://www.facebook.com/rangolibyprema">@rangolibyprema</a><br>\
        Mail <i class="fa fa-envelope-o"></i>: <a href="mailto:premaflorenceisaac@gmail.com">prema.florence.isaac@gmail.com</a><br>\
        WhatsApp <i class="fa fa-whatsapp"></i>: <a href="tel:+919443362528">+919443362528</a>\
            </div>\
            <div class="col-sm-6">\
                    Visit <i class="fa fa-map-marker"></i>: <a href="https://goo.gl/maps/rszKWi3P7xM2">Rangoli Atelier<br>Aurosarjan Complex, Auroshilpam<br>Auroville 605101<br>Tamil Nadu, India</a>\
            </div>\
        </div></center></div>\
        <center>Sign up for our (few-times-a-year) newsletter.<br>' + createMCSignup() + '</center>\
        <p class="text-center">'
    + botImgTag +
        '</p>\
        <p class="text-right">&copy; 2015 - 2020 Prema Florence Isaac</p>\
    </div>'
    ;
}



function kimBotMenu(location) {
    return botNav('<img src="/g/kimgphsimp.svg" alt="KidinMi Graphic" class="img-fluid center-block" width="300px">', location);
}

function botMenu(location) {
    return botNav('<img src="/g/since199900.svg" alt="Rangoli Graphic" class="img-fluid center-block" width="300px">', location);
}

function scriptSrcs() {
    return '\
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">\
<script async defer src="//assets.pinterest.com/js/pinit.js"></script>\
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>\
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script><script type="text/javascript" src="https://www.paypalobjects.com/api/checkout.js"></script>\
    ';
}

function getShopTop() {
return '<div class="modal fade" id="shopping-cart" tabindex="-1" role="dialog" aria-labelledby="shoppingCartTitle" aria-hidden="true"> <div class="modal-dialog modal-dialog-centered" role="document"> <div class="modal-content"> <div class="modal-header"> <div class="modal-title" id="shoppingCartTitle"> <div class="row p-1 text-left"> <strong>Your Shopping Cart</strong> </div></div><button type="button" class="close" data-dismiss="modal" aria-label="Close"> <span aria-hidden="true">&times;</span> </button> </div><div class="modal-body"> <div class="item p-1 text-left"> <strong><span>Total: <span class="sc-currency-string"><i class="fa fa-inr"> </i></span> <span class="sc-total">0</span></span></strong><br><span>Subtotal: <span class="sc-currency-string"><i class="fa fa-inr"> </i></span> <span class="sc-subtotal">0</span></span><br><span>Shipping: <span class="sc-currency-string"><i class="fa fa-inr"></i></span> <span class="sc-shipping">0</span></span> </div><div class="item sc-item-list"> </div><div class="row p-1" style="background-color: white; color: black"> <div class="col align-self-center"><span></span></div></div></div><div class="modal-footer"> <button class="btn btn-secondary btn-sm sc-save-changes float-left" type="button">Save Cart</button> <button class="btn btn-warning btn-sm sc-checkout float-right" type="button">Checkout</button> </div></div></div></div><div class="modal fade" id="checkout-form" tabindex="-1" role="dialog" aria-labelledby="checkoutFormTitle" aria-hidden="true"> <div class="modal-dialog modal-dialog-centered" role="document"> <div class="modal-content"> <div class="modal-header"> <div class="modal-title" id="checkoutFormTitle"> <p><strong>Checkout with Paypal<span class="align-top">*</span></strong></p></div><button type="button" class="close" data-dismiss="modal" aria-label="Close"> <span aria-hidden="true">&times;</span> </button> </div><div class="modal-body"> <div id="form-group" class="row p-1" style="background-color: white; color: black"> <div class="col text-center"> <div class="form-check form-check-inline"> <input class="form-check-input" id="sc-ship-to-india" type="checkbox" value=""> <label class="form-check-label" for="sc-ship-to-india">Ship to India</label> </div><div class="form-check form-check-inline"> <input class="form-check-input" id="sc-ship-express" type="checkbox" value=""> <label class="form-check-label" for="sc-ship-express">Express Shipping</label> </div></div></div><div class="row p-1"> <div class="col-12"> <p class="float-left"><small><strong><span>Total: <span class="sc-currency-string"><i class="fa fa-inr"></i></span> <span class="sc-total">0</span></span></strong><br><span>Subtotal: <span class="sc-currency-string"><i class="fa fa-inr"> </i></span> <span class="sc-subtotal">0</span></span><br><span>Shipping: <span class="sc-currency-string"><i class="fa fa-inr"></i></span> <span class="sc-shipping">0</span></span></small></p><div id="sc-paypal-btn" class="float-right"></div></div></div><div class="item sc-item-list"> </div></div><div class="modal-footer sc-checkout-btn"> <div> <p><span class="align-top">*</span><small>To maximize the security of your data, we do not collect your personal details on our website. When you complete your secure payment through PayPal, we receive your contact information and shipping address from them.</small></p></div></div></div></div></div><div class="modal fade" id="paypal-return" tabindex="-1" role="dialog" aria-hidden="true"> <div class="modal-dialog modal-dialog-centered" role="document"> <div class="modal-content"> <div class="modal-header"> <div class="modal-title pptitle"></div><button type="button" class="close" data-dismiss="modal" aria-label="Close"> <span aria-hidden="true">&times;</span> </button> </div><div class="modal-body"> <p class="ppmessage"></p></div></div></div></div>';
}

function getShopHeader() {
return '<div class="container"> <div class="row py-1"> <div class="col-12"><div id="currencies" class="text-left float-left" style="font-size: 12px"><span data-currency="INR" id="currencies-inr">INR(&#8377;)</span><span data-currency="GBP" id="currencies-gbp">GBP(&pound;)</span> <span data-currency="EUR" id="currencies-eur">EUR(&euro;)</span> <span data-currency="USD" id="currencies-usd">USD(&dollar;)</span></div><div id="shop-cart-summary" class="text-right float-right" style="font-size: 12px"> <a id="sc-edit-id" class="disabled" aria-disabled="true" type="button" data-toggle="modal" data-target="#shopping-cart"> <i class="fa fa-shopping-cart"></i> (<span class="sc-badge-items">0</span>) <span class="sc-non-empty" style="display:none"> - </span> <span class="sc-currency-string sc-non-empty" style="display:none"><i class="fa fa-inr"></i></span> <span class="sc-total sc-non-empty" style="display:none">0</span> </a> <div class="item sc-item-list" style="display: none"> </div></div></div></div></div>';
}
